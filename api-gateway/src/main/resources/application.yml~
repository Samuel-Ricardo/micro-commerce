server:
  port: 9000

spring:
  application:
    name: api-gateway

  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${KEYCLOAK_ISSUER_URI}


services:
  url:
    product: ${PRODUCT_SERVICE_URL}
    order: ${ORDER_SERVICE_URL}
    inventory: ${INVENTORY_SERVICE_URL}


springdoc:
  api-docs:
    path: ${API_DOCS_PATH}
  swagger-ui:
    path: ${API_DOCS_UI_PATH}
    urls:
      - name: Product Service
        url: /aggregate/product-service/v3/api-docs
      - name: Order Service
        url: /aggregate/order-service/v3/api-docs
      - name: Inventory Service
        url: /aggregate/inventory-service/v3/api-docs

management:
  health:
    circuitbreakers:
      enabled: ${CIRCUIT_BREAKER_ENABLED}
  endpoints:
    web:
      exposure:
        include: ${ENDPOINTS_WEB_EXPOSURE_INCLUDE}
  endpoint:
    health:
      show-details: ${ENDPOINTS_HEALTH_SHOW_DETAILS}

resilience4j:
  circuitbreaker:
    configs:
      default:
        registerHealthIndicator: ${REGISTER_HEALTH_INDICATOR}
        slidingWindowType: ${SLIDING_WINDOW_TYPE}
        slidingWindowSize: ${SLIDING_WINDOW_SIZE}
        failureRateThreshold: ${FAILURE_RATE_THRESHOLD}
        waitDurationInOpenState: ${WAIT_DURATION_IN_OPEN_STATE}
        permittedNumberOfCallsInHalfOpenState: ${PERMITTED_NUMBER_OF_CALLS_IN_HALF_OPEN_STATE}
        automaticTransitionFromOpenToHalfOpenEnabled: ${AUTOMATIC_TRANSITION_FROM_OPEN_TO_HALF_OPEN_ENABLED}
        minimum-number-of-calls: ${MINIMUM_NUMBER_OF_CALLS}

  timelimiter:
    configs:
      default:
        timeout-duration: ${TIMEOUT_DURATION}

  retry:
    configs:
      default:
        max-attempts: ${MAX_ATTEMPTS}
        wait-duration: ${WAIT_DURATION_BETWEEN_ATTEMPTS}